<!DOCTYPE html>
<html>
  <head>
    <title>PyScript XLS Viewer</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
  </head>
  <body>
    <h1>XLS Table Viewer with PyScript</h1>
    <input type="file" id="file-input" accept=".xls,.xlsx" />
    <div id="output"></div>

    <py-config>
      packages = ["pandas", "openpyxl", "xlrd"]
    </py-config>

    <py-script>
import js
import pandas as pd

from pyodide_http import patch_all
patch_all()

DATA_URL = "https://raw.githubusercontent.com/leriomaggio/pyscript-fetch-resources/main/employee.xlsx"

# read excel through pandas
df = pd.read_excel(DATA_URL, sheet_name='Data')

# get the element with id= "sheet"
sheet = js.document.getElementById("sheet")

# write spreadsheet into paragraph
sheet.innerHTML = df.to_html()

print(df)
    </py-script>
  </body>
</html>
